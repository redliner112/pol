<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<script>

function doSelect(){
	var idStr = "username,command";
	var lengthStr = "30,100";
	var typeStr="s,s";
	var params = "?";
	var ids = idStr.split(",");
	var types = typeStr.split(",");
	for(var i=0;i<ids.length;i++){
		var maxLength = new Number(lengths[i]);
		var typeVali = types[i];
		var elObj = document.getElementByDi(ids[i]);
		if(!isNaN(maxLength)){
			if(elObj.value.length>maxLength){
				alert("제한길이를 넘었습니다.");
				elObj.value = "";
				elObj.focus();
				return
			}
		}
		if(typeVali=="n"){
			if(isNaN(new Number(elObj.value))){
				alert("숫자만 입력해주세요");
				elObj.value = "";
				elObj.focus();
				return;
			}
		}
			
		params +=ids[i] +"=" + elObj.value + "&";
	}
	var au = new AjaxUtil(params);
	au.changeCallBack(function(){
		if(au.xhr.readyState==4){
			if(au.xhr.status==200){
				var result= decodeURIComponent(au.xhr.responseText);
				var rows = result.split("{+}");
				var thdEnables = rows[1].split("{/}");
				var tableStr = "<table border='1'>";
				
				for(var i=0;i<rows.length;i++){
					if(i==1){
						continue;//뭐지?첫번재 컬럼값이라서 넘값이라서 넘어간다는소리인가?
					}
					tableStr +="<tr>";
					var columns = rows[i].split("{/}");
					var userNum;
					for(var j=0;j<columns.length;j++){
						if(j==0){
							userNum = columns[j];
						}
						if(i==0){//이 두 if가 이해가 잘안됨.
							tableStr +="<td>"+columns[j] + "</td>";
						}else{
							if(tdEnables[j]=="en"){
								tableStr += "<td><input type = 'text' value='" + columns[j] + "'id='r"+userNum+j+"'/></td>";
							}else{
								tableStr +="<td>" + columns[j] +"</td>";
							}
						}
					}
					if(i==0){
						tableStr +="<td>삭제</td>";
						tableStr +="<td>수정</td>";
					}else{
						tableStr +="<td><input type = 'button' value = '삭제' onclick='doDelete("+userNum+")'></td>";
						tableStr +="<td><input type = 'button' value = '수정' onclick='doUpdate("+userNum +")'/></td>";
					}
					tableStr +="</tr>";
				}
				if(rows.length==1){//rows.length==1이란건 컬럼명값일떄?
					tableStr +="<tr><tdcolspan='3'>니가 검색한거 없어</td></tr>";
				}
				tableStr +="</table>";
				document.getElementById("bd_div").innerHTML = tableStr;
			}else{
				document.getElementById("bd_div").innerHTML = xhr.responseText;
			}
		}
	});
	au.send();
}		
	
</script>
<body>
이름 : <input type="text" name="username" id="username"/> <input type="button" value="검색"onclick = "doSelect()"/>
<input type="hidden" name="command" id = "command" value="SELECT"/>
<div id = "bd_div"></div>
</body>
</html>